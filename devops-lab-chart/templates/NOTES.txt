ðŸŽ‰ DevOps Lab Application has been deployed!

Your release is named {{ .Release.Name }}.

To access your application:

{{- if .Values.ingress.enabled }}

1. Access via Ingress:
{{- range .Values.ingress.hosts }}
   http{{ if $.Values.ingress.tls }}s{{ end }}://{{ .host }}
{{- end }}

{{- else }}

1. Get the application URL by running:

{{- if contains "NodePort" .Values.service.type }}
   export NODE_PORT=$(kubectl get --namespace {{ .Values.namespace.name }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ include "devops-lab-chart.fullname" . }})
   export NODE_IP=$(kubectl get nodes --namespace {{ .Values.namespace.name }} -o jsonpath="{.items[0].status.addresses[0].address}")
   echo http://$NODE_IP:$NODE_PORT

{{- else if contains "LoadBalancer" .Values.service.type }}
   NOTE: It may take a few minutes for the LoadBalancer IP to be available.
         You can watch the status by running 'kubectl get --namespace {{ .Values.namespace.name }} svc -w {{ include "devops-lab-chart.fullname" . }}'

   export SERVICE_IP=$(kubectl get svc --namespace {{ .Values.namespace.name }} {{ include "devops-lab-chart.fullname" . }} --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}"}}")
   echo http://$SERVICE_IP:{{ .Values.service.port }}

{{- else if contains "ClusterIP" .Values.service.type }}
   export POD_NAME=$(kubectl get pods --namespace {{ .Values.namespace.name }} -l "app.kubernetes.io/name={{ include "devops-lab-chart.name" . }},app.kubernetes.io/instance={{ .Release.Name }}" -o jsonpath="{.items[0].metadata.name}")
   echo "Visit http://127.0.0.1:8080 to use your application"
   kubectl --namespace {{ .Values.namespace.name }} port-forward $POD_NAME 8080:{{ .Values.service.targetPort }}

{{- end }}
{{- end }}

2. Check application health:
   kubectl exec -n {{ .Values.namespace.name }} deployment/{{ include "devops-lab-chart.fullname" . }} -- wget -q -O- http://localhost:3000/health

3. View Prometheus metrics:
   kubectl exec -n {{ .Values.namespace.name }} deployment/{{ include "devops-lab-chart.fullname" . }} -- wget -q -O- http://localhost:3000/metrics

4. Check application logs:
   kubectl logs -n {{ .Values.namespace.name }} -l app=node-app --tail=50 -f

5. View pod status:
   kubectl get pods -n {{ .Values.namespace.name }} -l app=node-app

{{- if .Values.autoscaling.enabled }}

âš¡ Autoscaling is ENABLED:
   - Min replicas: {{ .Values.autoscaling.minReplicas }}
   - Max replicas: {{ .Values.autoscaling.maxReplicas }}
   - Target CPU: {{ .Values.autoscaling.targetCPUUtilizationPercentage }}%
   {{- if .Values.autoscaling.targetMemoryUtilizationPercentage }}
   - Target Memory: {{ .Values.autoscaling.targetMemoryUtilizationPercentage }}%
   {{- end }}

   Check HPA status:
   kubectl get hpa -n {{ .Values.namespace.name }}

{{- else }}

ðŸ“Š Current replica count: {{ .Values.replicaCount }}

To enable autoscaling, upgrade with:
   helm upgrade {{ .Release.Name }} {{ .Chart.Name }} --set autoscaling.enabled=true

{{- end }}

ðŸ“š Useful Commands:

# Upgrade the release
helm upgrade {{ .Release.Name }} {{ .Chart.Name }} -f values.yaml

# Rollback to previous version
helm rollback {{ .Release.Name }}

# Show release history
helm history {{ .Release.Name }}

# Uninstall the release
helm uninstall {{ .Release.Name }} -n {{ .Values.namespace.name }}

# Get all release values
helm get values {{ .Release.Name }}

Happy deploying! ðŸš€
